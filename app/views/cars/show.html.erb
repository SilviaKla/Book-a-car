<div class ="car-show">
 <h2 id="title">Book My Car</h2>

  <div class="container-show-top">
    <div class="row">
      <div class="col-sm-8">
      <%= cl_image_tag @car.photos.first.key %>
      </div>


      <div class="col-sm-4">
      <h2><%= @car.name %></h2>
      <p><%= @car.description %></p>
      <ul>
      <li><button type="button" class="btn btn-outline-dark">€ <%= @car.price_per_day %> per day</button></li>
      <li><button type="button" class="btn btn-outline-dark">Seats: <%= @car.places %></button></li>
      <li><button type="button" class="btn btn-outline-dark"><%= @car.km %> Km</button></li>
      <li><button type="button" class="btn btn-outline-dark"> air Conditioning: <%= @car.air_conditioning %></button></li>
      </ul>
      </div>
    </div>
  </div>

  <div class="container-show-bottom">
    <div class="row">
      <div class="col-sm-6">
        <h4><%= @car.location %></h4>
        <div id = "map2"
            data-controller="map"
            data-map-markers-value="<%= @markers.to_json %>"
            data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
        </div>
      </div>


      <div class="col-sm-6">
        <div class="form-wrapper" style="width: 400px; margin: 0 auto;">
          <h3>Book this car</h3>
          <div id='car-booking-dates' data-unavailable="<%= @car.unavailable_dates.to_json %>">
             <% if current_user.id != @car.user_id  %>
                <%= simple_form_for([@car, @booking]) do |f| %>
                  <%= f.input :start_date, as: :string, type: :text, required: false, input_html: {class: "datepicker"} %>
                  <%= f.input :end_date, as: :string, type: :text, required: false, input_html: {class: "datepicker"} %>
                  <%= f.submit "Book", class: "btn btn-dark" %>
                <% end %>
             <% end %>
          </div>
          <% @bookings.each do |booking| %>
          <p> Total Price per <%=((booking.end_date.to_time - booking.start_date.to_time).to_i) / (60 * 60 * 24)%> days: <%=booking.total_price = (((booking.end_date.to_time - booking.start_date.to_time).to_i) / (60 * 60 * 24)) * @car.price_per_day %> €</p>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
